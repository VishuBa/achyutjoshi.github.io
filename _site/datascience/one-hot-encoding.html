<!DOCTYPE html>
<html>
  <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>One Hot Encoding in Data Science - Achyut Joshi</title>
<meta property="og:title" content="One Hot Encoding in Data Science" />
<meta name="description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<meta property="og:description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<link rel="canonical" href="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:url" content="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:site_name" content="Achyut Joshi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-08-15T00:43:39+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="fb:admins" content="ajoshi1995" />
<meta property="fb:app_id" content="1605837139430627" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "One Hot Encoding in Data Science",
"datePublished": "2016-08-15T00:43:39+05:30",
"description": "I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding.",
"url": "http://localhost:4000/datascience/one-hot-encoding"}</script>
<!-- End Jekyll SEO tag -->


  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>One Hot Encoding in Data Science</title>
    <meta name="description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any p...">

    <link rel="stylesheet" href="/assets/css/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,700' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/x-icon" href="http://localhost:4000/favicon.ico">

    <link rel="canonical" href="http://localhost:4000/datascience/one-hot-encoding">
    <link rel="alternate" type="application/rss+xml" title="Achyut Joshi" href="http://localhost:4000/feed.xml" />

    <!-- Google Analytics -->
    <!-- Remove this before deploying your Jekyll site -->
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76699034-1', 'auto');
  ga('require', 'linkid');

  ga('send', 'pageview');

</script>
<!-- Begin Jekyll SEO tag v2.1.0 -->
<title>One Hot Encoding in Data Science - Achyut Joshi</title>
<meta property="og:title" content="One Hot Encoding in Data Science" />
<meta name="description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<meta property="og:description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<link rel="canonical" href="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:url" content="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:site_name" content="Achyut Joshi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-08-15T00:43:39+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="fb:admins" content="ajoshi1995" />
<meta property="fb:app_id" content="1605837139430627" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "One Hot Encoding in Data Science",
"datePublished": "2016-08-15T00:43:39+05:30",
"description": "I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding.",
"url": "http://localhost:4000/datascience/one-hot-encoding"}</script>
<!-- End Jekyll SEO tag -->



  <meta content="http://localhost:4000/assets/images/profile1.png" property="og:image">

</head>


  <body>

    <header class="site-header">

    <div class="wrapper">

        <h1><a class="site-title" href="/">The Skeptical Being</a></h1>
        <!--<h2 class="site-tagline">Entrepreneur, Avid Traveller, IITian, Skeptic, Hustler and a lifelong learner</h2>-->


        <nav class="site-nav">
            <a href="/bloglanding/">Home</a>
            
                
            
                
            
                
                
                
            
                
            
                
                
                
            
                
                
                
            
                
                
                <a class="page-link" href="/datascience/">Data Science</a>
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
            
                
                
                
            
                
                
                <a class="page-link" href="/podcast/">Podcasts</a>
                
                
            
                
            
                
                
                <a class="page-link" href="/randomblog/">Random Scribblings</a>
                
                
            
                
                
                
            
                
                
                
            
                
                
                <a class="page-link" href="/reviews/">Reviews</a>
                
                
            
                
                
                
            
                
                
                
            
                
                
                <a class="page-link" href="/travel/">Travel</a>
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            

        </nav>

    </div> <!-- .wrapper -->
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h4 class="post-title">One Hot Encoding in Data Science</h4>
    <time class="post-date">August 15, 2016</time>
    <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>One Hot Encoding in Data Science - Achyut Joshi</title>
<meta property="og:title" content="One Hot Encoding in Data Science" />
<meta name="description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<meta property="og:description" content="I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding." />
<link rel="canonical" href="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:url" content="http://localhost:4000/datascience/one-hot-encoding" />
<meta property="og:site_name" content="Achyut Joshi" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-08-15T00:43:39+05:30" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta property="fb:admins" content="ajoshi1995" />
<meta property="fb:app_id" content="1605837139430627" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "BlogPosting",
"headline": "One Hot Encoding in Data Science",
"datePublished": "2016-08-15T00:43:39+05:30",
"description": "I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding.",
"url": "http://localhost:4000/datascience/one-hot-encoding"}</script>
<!-- End Jekyll SEO tag -->


  </header>

  <article class="post-content">
    <p>I consider myself a newbie for the data analysis world. What I have understood so far is that data preparation is the most important step while solving any problem. Each predictive  model requires a certain type of data and in a certain way. For instance, tree based boosting models like xgboost require all the feature variables to be numeric. While solving the San Francisco Crime Classification problem on Kaggle, I stumbled upon different ways to handle categorical variables. One of the method to convert a categorical input variable into a continuous one is One Hot Encoding/ Dummy coding.</p>

<!--more-->

<p>Many a times we have categorical variables with many levels. For example in the SF Crime Classification problem, there were 39 different levels of crime. Now many learning algorithms either learn a single weight per feature, or they use distances between samples. In both cases having a categorical variable with more levels will decrease the accuracy of the model. Let us look into both cases.</p>

<p><strong>Linear Model</strong> :</p>

<p>Suppose you have a dataset having only a single categorical feature “colour”, with values “Blue”, “Green” and “Red”. Assume, that these are encoded as 0, 1 and 2. You then have a weight w for this feature in a linear classifier, which will make some kind of decision based on the constraint w×x + b &gt; 0, or equivalently w×x &lt; b.</p>

<p>The problem now is that the weight w cannot encode a three-way choice. The three possible values of w×x are 0, w and 2×w. Either these three all lead to the same decision (they’re all &lt; b or ≥b) or “Blue” and “Green” lead to the same decision, or “Green” and “Red” give the same decision. There’s no possibility for the model to learn that “Blue” and “Red” should be given the same label, with “French” the odd one out.</p>

<p>Dummy coding will convert this colour feature into three features – ‘isgreen’ ‘isred’ and ‘isblue. By this, we effectively blow up the feature space to three features, which will each get their own weights, so the decision function is now w[Blue]x[Blue] + w[Green]x[Green] + w[Red]x[Red] &lt; b, where all the x’s are booleans. This easily caters the problem we were having before.</p>

<p><strong>Distance-Based</strong> :</p>

<p>Similarly, any learner based on standard distance metrics (such as k-nearest neighbors) between samples will get confused without one-hot encoding. With the naive encoding and Euclidean distance, the distance between Green and Red is 1. The distance between Red and Blue is 2. But with the one-hot encoding, the pairwise distances between [1, 0, 0], [0, 1, 0] and [0, 0, 1] are all equal to √2.</p>

<p>However, this is not true for all models. Decision trees and derived models such as random forests, if deep enough, can handle categorical variables without one-hot encoding.</p>

<p><strong>Other Methods used for Encoding</strong> –</p>

<ol>
  <li>Ordinal Coding – Assign Numbers to each categories</li>
  <li>Binary: first the categories are encoded as ordinal, then those integers are converted into binary code, then the digits from that binary string are split into separate columns.  This encodes the data in fewer dimensions that one-hot, but with some distortion of the distances.</li>
</ol>

<p>References: Quora &amp; Analytics Vidya</p>


    <a href="https://twitter.com/share" class="twitter-share-button" data-via="achyutjosh1995">Tweet</a>

<!-- Put this just before the closing body tag -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.8&appId=1605837139430627";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



<div class="fb-share-button" data-href="http://localhost:4000/datascience/one-hot-encoding" data-layout="button_count" target="_blank" style="position: relative; top: -8px; left: 33px;"></div>

                    


<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "http://localhost:4000/datascience/one-hot-encoding"; // <--- use canonical URL
this.page.identifier = "/datascience/one-hot-encoding";
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//https-achyutjoshi-github-io.disqus.com/embed.js'; // <--- use Disqus shortname

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  </article>

</div>

      </div> <!-- .wrapper -->
    </div> <!-- .page-content -->

    <footer class="site-footer">

  <div class="wrapper">
    <p class="rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a></p>
    
 

  </div> <!-- .wrapper -->

</footer>



  </body>

</html>
